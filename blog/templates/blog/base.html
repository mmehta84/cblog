<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}AI-QA Blog — Ideas Worth Sharing{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}A modern Django-powered blog.{% endblock %}" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            DEFAULT: '#0D3B38',
                            dark: '#082A27',
                            mid: '#1A5C57',
                            light: '#2E9D96',
                            pale: '#C8DEDC',
                            faint: '#EAF3F2',
                        },
                        accent: {
                            DEFAULT: '#C8601A',
                            dark: '#9E4A13',
                            mid: '#E0761F',
                            light: '#F5E2D0',
                            faint: '#FDF6F0',
                        },
                        parchment: '#F8F4ED',
                        cream: '#FFFCF5',
                        ink: '#1C1A16',
                        'ink-muted': '#6B6458',
                        'ink-faint': '#9B9287',
                    },
                    fontFamily: {
                        display: ['"Playfair Display"', 'Georgia', 'serif'],
                        sans: ['"DM Sans"', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,500;0,700;0,900;1,500;1,700&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <style>
        /* Design tokens */
        :root {
            --shadow-sm: 0 1px 3px rgba(13,59,56,0.07), 0 4px 8px rgba(13,59,56,0.05);
            --shadow-md: 0 4px 12px rgba(13,59,56,0.09), 0 16px 32px rgba(13,59,56,0.06);
            --shadow-lg: 0 8px 24px rgba(13,59,56,0.11), 0 32px 64px rgba(13,59,56,0.07);
            --shadow-hover: 0 12px 32px rgba(13,59,56,0.15), 0 40px 72px rgba(13,59,56,0.09);
            --shadow-accent: 0 4px 14px rgba(200,96,26,0.25), 0 12px 28px rgba(200,96,26,0.15);
        }

        /* Shadow utilities */
        .shadow-brand-sm  { box-shadow: var(--shadow-sm); }
        .shadow-brand-md  { box-shadow: var(--shadow-md); }
        .shadow-brand-lg  { box-shadow: var(--shadow-lg); }
        .shadow-accent-btn { box-shadow: var(--shadow-accent); }

        /* ── Underline hero (21st.dev pattern) ── */
        .hero-underline {
            position: absolute;
            left: 0;
            width: 100%;
            top: 100%;
            margin-top: -5px;
            pointer-events: none;
        }
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(10px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        .anim-fiu   { animation: fade-in-up 0.6s ease-out both; }
        .anim-fiu-1 { animation-delay: 0.2s; }
        .anim-fiu-2 { animation-delay: 0.4s; }
        .anim-fiu-3 { animation-delay: 0.6s; }

        @keyframes bulb-glow {
            0%, 100% {
                filter: drop-shadow(0 0 2px rgba(232,164,74,0.70))
                        drop-shadow(0 0 5px rgba(232,164,74,0.40));
                opacity: 1;
            }
            50% {
                filter: drop-shadow(0 0 6px rgba(232,164,74,1.00))
                        drop-shadow(0 0 14px rgba(232,164,74,0.65))
                        drop-shadow(0 0 26px rgba(200,96,26,0.35));
                opacity: 0.88;
            }
        }
        .bulb-glow { animation: bulb-glow 2.2s ease-in-out infinite; }

        /* Post card lift */
        .post-card {
            transition: transform 0.28s cubic-bezier(0.34, 1.56, 0.64, 1),
                        box-shadow 0.28s ease;
        }
        .post-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        /* Tag pill pop */
        .tag-pill {
            transition: transform 0.18s cubic-bezier(0.34, 1.56, 0.64, 1),
                        opacity 0.18s ease;
            display: inline-block;
        }
        .tag-pill:hover { transform: scale(1.08); }
        .tag-pill:active { transform: scale(0.96); opacity: 0.85; }

        /* Line clamp */
        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }

        /* Rich text body */
        .ck-content h1, .ck-content h2, .ck-content h3, .ck-content h4 {
            font-family: 'Playfair Display', Georgia, serif;
            font-weight: 700;
            margin: 1.6em 0 0.55em;
            color: #1C1A16;
        }
        .ck-content h1 { font-size: 2rem; }
        .ck-content h2 {
            font-size: 1.5rem;
            border-bottom: 2px solid #EAF3F2;
            padding-bottom: 0.35em;
        }
        .ck-content h3 { font-size: 1.25rem; }
        .ck-content p  { margin: 1.1em 0; line-height: 1.85; color: #3A352E; }
        .ck-content a  { color: #C8601A; text-decoration: underline; text-underline-offset: 2px; }
        .ck-content a:hover { color: #9E4A13; }
        .ck-content blockquote {
            border-left: 4px solid #C8601A;
            padding: 0.8em 1.3em;
            background: #FDF6F0;
            color: #6B6458;
            font-style: italic;
            margin: 1.6em 0;
            border-radius: 0 0.5rem 0.5rem 0;
        }
        .ck-content pre {
            background: #0D2420;
            color: #C8DEDC;
            padding: 1.3rem;
            border-radius: 0.75rem;
            overflow-x: auto;
            font-size: 0.875rem;
            line-height: 1.7;
            margin: 1.6em 0;
        }
        .ck-content code {
            background: #EAF3F2;
            color: #0D3B38;
            padding: 0.15em 0.45em;
            border-radius: 0.25rem;
            font-size: 0.875em;
        }
        .ck-content img {
            max-width: 100%;
            border-radius: 0.75rem;
            margin: 1.6em auto;
            display: block;
            box-shadow: var(--shadow-md);
        }
        .ck-content ul, .ck-content ol { padding-left: 1.75rem; margin: 1em 0; }
        .ck-content li { margin: 0.55em 0; line-height: 1.75; color: #3A352E; }
        .ck-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.6em 0;
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .ck-content th {
            background: #0D3B38;
            color: #FFFCF5;
            padding: 0.75rem 1rem;
            text-align: left;
            font-size: 0.875rem;
        }
        .ck-content td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #EAF3F2;
            font-size: 0.875rem;
            color: #3A352E;
        }
        .ck-content tr:nth-child(even) td { background: #F8F4ED; }
    </style>
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-parchment font-sans antialiased text-ink min-h-screen flex flex-col">

<!-- NAVBAR -->
<nav class="bg-cream sticky top-0 z-50" style="border-bottom: 1px solid rgba(13,59,56,0.10); box-shadow: var(--shadow-sm);">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">

            <!-- Logo -->
            <a href="{% url 'blog:post_list' %}" class="flex items-center gap-3 group focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40 rounded-xl p-0.5"
               style="text-decoration: none;">
                <!-- Monogram badge -->
                <div class="flex-shrink-0 rounded-[10px] flex items-center justify-center"
                     style="width: 38px; height: 38px; background: #0D3B38;
                            box-shadow: 0 2px 8px rgba(13,59,56,0.28), 0 6px 18px rgba(13,59,56,0.16);
                            transition: transform 0.22s cubic-bezier(0.34,1.56,0.64,1);">
                    <span style="font-family: 'Playfair Display', Georgia, serif; font-weight: 700;
                                 color: #C8601A; font-size: 15px; letter-spacing: -0.5px; line-height: 1;">AQ</span>
                </div>
                <!-- Stacked name -->
                <div class="hidden sm:flex flex-col leading-none">
                    <span style="font-family: 'Playfair Display', Georgia, serif; font-weight: 700;
                                 color: #0D3B38; font-size: 1.05rem; letter-spacing: -0.03em; line-height: 1.15;">AI-QA</span>
                    <span style="font-family: 'DM Sans', system-ui, sans-serif; font-weight: 500;
                                 color: #9B9287; font-size: 0.6rem; letter-spacing: 0.16em;
                                 text-transform: uppercase; line-height: 1.3;">Blog</span>
                </div>
            </a>

            <!-- Search (React) -->
            <div class="hidden md:flex flex-1 max-w-sm mx-6 justify-start">
                <div id="react-search-bar" data-search-url="{% url 'blog:search' %}"></div>
            </div>

            <!-- Nav Links -->
            <div class="flex items-center gap-1">
                <a href="{% url 'blog:post_list' %}"
                   class="px-3 py-2 text-sm font-medium text-ink-muted rounded-lg hover:text-brand hover:bg-brand-faint active:opacity-80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40"
                   style="transition: color 0.15s, background-color 0.15s;">Home</a>
                <a href="{% url 'blog:search' %}"
                   class="px-3 py-2 text-sm font-medium text-ink-muted rounded-lg hover:text-brand hover:bg-brand-faint active:opacity-80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40 md:hidden"
                   style="transition: color 0.15s, background-color 0.15s;">Search</a>

                {% if user.is_authenticated %}
                    <a href="{% url 'blog:post_create' %}"
                       class="ml-1 px-4 py-2 text-sm font-semibold text-cream rounded-full active:scale-[0.97] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent/60 focus-visible:ring-offset-2"
                       style="background: #C8601A; box-shadow: var(--shadow-accent); transition: background-color 0.15s, transform 0.15s;"
                       onmouseover="this.style.background='#9E4A13'" onmouseout="this.style.background='#C8601A'">
                        + Write
                    </a>
                    <a href="/admin/"
                       class="px-3 py-2 text-sm font-medium text-ink-muted rounded-lg hover:text-brand hover:bg-brand-faint active:opacity-80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40"
                       style="transition: color 0.15s, background-color 0.15s;">Admin</a>
                    <form method="POST" action="{% url 'logout' %}" class="inline">
                        {% csrf_token %}
                        <button type="submit"
                                class="px-3 py-2 text-sm font-medium text-ink-muted rounded-lg hover:text-red-600 hover:bg-red-50 active:opacity-80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-400/40"
                                style="transition: color 0.15s, background-color 0.15s;">Logout</button>
                    </form>
                {% else %}
                    <a href="{% url 'login' %}"
                       class="ml-1 px-4 py-2 text-sm font-semibold text-brand rounded-full hover:bg-brand-faint active:scale-[0.97] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40 focus-visible:ring-offset-2"
                       style="border: 1.5px solid #0D3B38; transition: background-color 0.15s, transform 0.15s;">Login</a>
                {% endif %}
            </div>
        </div>
    </div>
</nav>

<!-- FLASH MESSAGES -->
{% if messages %}
<div class="max-w-7xl mx-auto px-4 pt-4 sm:px-6 lg:px-8">
    {% for message in messages %}
    <div class="flex items-center gap-3 p-4 mb-2 rounded-xl text-sm font-medium
        {% if message.tags == 'success' %}bg-brand-faint text-brand border border-brand-pale
        {% elif message.tags == 'error' %}bg-red-50 text-red-800 border border-red-200
        {% else %}bg-accent-faint text-accent border border-accent-light{% endif %}">
        <svg class="w-5 h-5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
        </svg>
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- MAIN CONTENT -->
<main class="flex-1">
    {% block content %}{% endblock %}
</main>

<!-- FOOTER -->
<footer class="text-brand-pale mt-16" style="background: #082A27;">
    <div class="max-w-7xl mx-auto px-4 py-12 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-8">
            <div>
                <div class="flex items-center gap-3 mb-3">
                    <div class="flex-shrink-0 rounded-[10px] flex items-center justify-center"
                         style="width: 38px; height: 38px; background: #1A5C57;">
                        <span style="font-family: 'Playfair Display', Georgia, serif; font-weight: 700;
                                     color: #C8601A; font-size: 15px; letter-spacing: -0.5px; line-height: 1;">AQ</span>
                    </div>
                    <div class="flex flex-col leading-none">
                        <span style="font-family: 'Playfair Display', Georgia, serif; font-weight: 700;
                                     color: #FFFCF5; font-size: 1.05rem; letter-spacing: -0.03em; line-height: 1.15;">AI-QA</span>
                        <span style="font-family: 'DM Sans', system-ui, sans-serif; font-weight: 500;
                                     color: rgba(200,222,220,0.55); font-size: 0.6rem; letter-spacing: 0.16em;
                                     text-transform: uppercase; line-height: 1.3;">Blog</span>
                    </div>
                </div>
                <p class="text-sm leading-relaxed" style="color: rgba(200,222,220,0.65);">A modern blog built with Django and Tailwind CSS.</p>
            </div>
            <div>
                <h4 class="font-semibold text-cream mb-3 text-sm uppercase tracking-wider">Categories</h4>
                <ul class="space-y-1.5">
                    {% for cat in categories|slice:":5" %}
                    <li>
                        <a href="{{ cat.get_absolute_url }}"
                           class="text-sm hover:text-accent active:opacity-70 focus-visible:outline-none focus-visible:underline"
                           style="color: rgba(200,222,220,0.65); transition: color 0.15s;">{{ cat.name }}</a>
                    </li>
                    {% empty %}
                    <li class="text-sm" style="color: rgba(200,222,220,0.40);">No categories yet.</li>
                    {% endfor %}
                </ul>
            </div>
            <div>
                <h4 class="font-semibold text-cream mb-3 text-sm uppercase tracking-wider">Quick Links</h4>
                <ul class="space-y-1.5">
                    <li><a href="{% url 'blog:post_list' %}" class="text-sm hover:text-accent active:opacity-70 focus-visible:outline-none focus-visible:underline" style="color: rgba(200,222,220,0.65); transition: color 0.15s;">Home</a></li>
                    <li><a href="{% url 'blog:search' %}" class="text-sm hover:text-accent active:opacity-70 focus-visible:outline-none focus-visible:underline" style="color: rgba(200,222,220,0.65); transition: color 0.15s;">Search</a></li>
                    {% if user.is_authenticated %}
                    <li><a href="{% url 'blog:post_create' %}" class="text-sm hover:text-accent active:opacity-70 focus-visible:outline-none focus-visible:underline" style="color: rgba(200,222,220,0.65); transition: color 0.15s;">Write a Post</a></li>
                    <li><a href="/admin/" class="text-sm hover:text-accent active:opacity-70 focus-visible:outline-none focus-visible:underline" style="color: rgba(200,222,220,0.65); transition: color 0.15s;">Admin Panel</a></li>
                    {% else %}
                    <li><a href="{% url 'login' %}" class="text-sm hover:text-accent active:opacity-70 focus-visible:outline-none focus-visible:underline" style="color: rgba(200,222,220,0.65); transition: color 0.15s;">Login</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
        <div class="mt-8 pt-6 text-center text-xs" style="border-top: 1px solid rgba(200,222,220,0.12); color: rgba(200,222,220,0.40);">
            Built with Django &amp; Tailwind CSS &mdash; {% now "Y" %} AI-QA Blog
        </div>
    </div>
</footer>

<!-- React (loaded before extra_js so child pages can use it) -->
<script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>

{% block extra_js %}{% endblock %}
<script>
(function () {
    const { useState, useRef } = React;

    function SearchBar({ searchUrl }) {
        const [isOpen, setIsOpen] = useState(false);
        const [query, setQuery] = useState('');
        const inputRef = useRef(null);

        const open = () => {
            setIsOpen(true);
            setTimeout(() => inputRef.current && inputRef.current.focus(), 50);
        };

        const close = () => { setIsOpen(false); setQuery(''); };

        const handleSubmit = (e) => {
            e.preventDefault();
            if (query.trim()) window.location.href = searchUrl + '?query=' + encodeURIComponent(query.trim());
        };

        const handleKeyDown = (e) => { if (e.key === 'Escape') close(); };

        const e = React.createElement;

        return e('div', { style: { display: 'flex', alignItems: 'center', gap: '4px' } },
            e('form', { onSubmit: handleSubmit, style: { display: 'flex', alignItems: 'center', gap: '4px' } },

                // Expanding input
                e('div', {
                    style: {
                        overflow: 'hidden',
                        width: isOpen ? '220px' : '0px',
                        opacity: isOpen ? 1 : 0,
                        transition: 'width 0.35s cubic-bezier(0.34,1.56,0.64,1), opacity 0.2s ease',
                    }
                },
                    e('input', {
                        ref: inputRef,
                        type: 'text',
                        value: query,
                        onChange: (ev) => setQuery(ev.target.value),
                        onKeyDown: handleKeyDown,
                        placeholder: 'Search articles\u2026',
                        style: {
                            width: '220px',
                            padding: '7px 14px',
                            fontSize: '0.875rem',
                            color: '#1C1A16',
                            background: '#F8F4ED',
                            border: '1px solid rgba(13,59,56,0.18)',
                            borderRadius: '9999px',
                            outline: 'none',
                            fontFamily: "'DM Sans', system-ui, sans-serif",
                        }
                    })
                ),

                // Search / submit button
                e('button', {
                    type: isOpen ? 'submit' : 'button',
                    onClick: !isOpen ? open : undefined,
                    title: isOpen ? 'Search' : 'Open search',
                    style: {
                        width: '36px', height: '36px', borderRadius: '50%',
                        display: 'flex', alignItems: 'center', justifyContent: 'center',
                        background: isOpen ? '#0D3B38' : 'transparent',
                        border: 'none', cursor: 'pointer', flexShrink: 0,
                        transition: 'background-color 0.2s ease, transform 0.15s ease',
                    },
                    onMouseEnter: (ev) => { ev.currentTarget.style.transform = 'scale(1.08)'; },
                    onMouseLeave: (ev) => { ev.currentTarget.style.transform = 'scale(1)'; },
                    onMouseDown:  (ev) => { ev.currentTarget.style.transform = 'scale(0.94)'; },
                    onMouseUp:    (ev) => { ev.currentTarget.style.transform = 'scale(1)'; },
                },
                    e('svg', { width: 16, height: 16, fill: 'none', stroke: isOpen ? '#FFFCF5' : '#6B6458', viewBox: '0 0 24 24' },
                        e('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: '2', d: 'M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z' })
                    )
                )
            ),

            // Close button
            isOpen && e('button', {
                type: 'button',
                onClick: close,
                title: 'Close',
                style: {
                    width: '28px', height: '28px', borderRadius: '50%',
                    display: 'flex', alignItems: 'center', justifyContent: 'center',
                    background: 'rgba(13,59,56,0.08)', border: 'none', cursor: 'pointer',
                    flexShrink: 0, transition: 'background-color 0.15s ease',
                },
                onMouseEnter: (ev) => { ev.currentTarget.style.background = 'rgba(13,59,56,0.16)'; },
                onMouseLeave: (ev) => { ev.currentTarget.style.background = 'rgba(13,59,56,0.08)'; },
            },
                e('svg', { width: 12, height: 12, fill: 'none', stroke: '#6B6458', viewBox: '0 0 24 24' },
                    e('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: '2', d: 'M6 18L18 6M6 6l12 12' })
                )
            )
        );
    }

    const container = document.getElementById('react-search-bar');
    if (container) {
        ReactDOM.createRoot(container).render(
            React.createElement(SearchBar, { searchUrl: container.dataset.searchUrl })
        );
    }
})();
</script>
</body>
</html>
